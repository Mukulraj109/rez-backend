
> user-backend@1.0.0 test:e2e-merchant
> node tests/e2e/merchant-endpoints-test.js


================================================================================
  MERCHANT BACKEND E2E TEST SUITE - 122+ ENDPOINTS
  Base URL: http://localhost:5001
================================================================================


ğŸ” Checking Backend Connectivity...

  âœ“ Backend is running and healthy

ğŸ“¦ Testing Authentication Endpoints (11 endpoints)...
  âœ“ POST /api/merchant/auth/register - Register new merchant
  âœ“ POST /api/merchant/auth/login - Login merchant
  âœ“ GET /api/merchant/auth/me - Get current merchant (47ms)
  âœ“ PUT /api/merchant/auth/change-password - Change password (467ms)
  âœ“ POST /api/merchant/auth/forgot-password - Request password reset (262ms)
  âœ— POST /api/merchant/auth/reset-password - Reset password (invalid token) (5ms)
  âœ— POST /api/merchant/auth/verify-email - Verify email (invalid token) (4ms)
  âœ— POST /api/merchant/auth/logout - Logout merchant (5ms)

ğŸ“¦ Testing Dashboard Endpoints (6 endpoints)...
  âœ“ GET /api/merchant/dashboard - Get dashboard overview (221ms)
  âœ“ GET /api/merchant/dashboard/metrics - Get metric cards (47ms)
  âœ— GET /api/merchant/dashboard/activity - Get recent activity (65ms)
  âœ— GET /api/merchant/dashboard/top-products - Get top selling products (45ms)
  âœ— GET /api/merchant/dashboard/sales-data - Get sales chart data (63ms)
  âœ— GET /api/merchant/dashboard/low-stock - Get low stock alerts (42ms)

ğŸ“¦ Testing Onboarding Endpoints (16 endpoints)...
  âœ— GET /api/merchant/onboarding/status - Get onboarding status (44ms)
  âœ— POST /api/merchant/onboarding/step/1 - Save step 1 data (47ms)
  âœ— POST /api/merchant/onboarding/step/2 - Save step 2 data (47ms)
  âœ“ POST /api/merchant/onboarding/step/3 - Save step 3 data (66ms)
  âœ“ POST /api/merchant/onboarding/step/4 - Save step 4 data (67ms)
  âœ— POST /api/merchant/onboarding/step/5 - Save step 5 data (45ms)
  âœ— POST /api/merchant/onboarding/submit - Submit for approval (3ms)
  âœ“ GET /api/merchant/onboarding/documents - Get uploaded documents (47ms)

ğŸ“¦ Testing Team Management Endpoints (10 endpoints)...
  âœ— GET /api/merchant/team - List team members (45ms)
  âœ— POST /api/merchant/team/invite - Invite team member (351ms)
  âœ“ GET /api/merchant/team/me/permissions - Get my permissions (28ms)

ğŸ“¦ Testing Product Endpoints (23 endpoints)...
  âœ“ GET /api/merchant/products - List products (46ms)
  âœ— POST /api/merchant/products - Create product (25ms)
  â—‹ GET /api/merchant/products/:id - Get single product
  â—‹ PUT /api/merchant/products/:id - Update product
  â—‹ GET /api/merchant/products/:id/variants - Get product variants
  â—‹ POST /api/merchant/products/:id/variants - Create variant
  â—‹ GET /api/merchant/products/:id/reviews - Get product reviews
  âœ“ GET /api/merchant/bulk/products/template - Download import template (32ms)
  âœ“ GET /api/merchant/bulk/products/export - Export products (49ms)

ğŸ“¦ Testing Order Endpoints (10 endpoints)...
  âœ— GET /api/merchant/orders - List orders (5ms)
  âœ— GET /api/merchant/orders/analytics - Get order analytics (4ms)

ğŸ“¦ Testing Cashback Endpoints (11 endpoints)...
  âœ— GET /api/merchant/cashback - List cashback requests (4ms)
  âœ— GET /api/merchant/cashback/stats - Get cashback statistics (4ms)
  âœ— GET /api/merchant/cashback/pending-count - Get pending count (5ms)
  âœ— GET /api/merchant/cashback/export - Export cashback data (4ms)

ğŸ“¦ Testing Notification Endpoints (18 endpoints)...
  âœ— GET /api/merchant/notifications - List notifications (4ms)
  âœ— GET /api/merchant/notifications/unread-count - Get unread count (5ms)
  âœ— GET /api/merchant/notifications/stats - Get notification stats (3ms)
  âœ— POST /api/merchant/notifications/mark-all-read - Mark all as read (3ms)
  âœ— DELETE /api/merchant/notifications/clear-all - Clear all notifications (2ms)

ğŸ“¦ Testing Analytics Endpoints (17 endpoints)...
  âœ— GET /api/merchant/analytics/sales/overview - Sales overview (42ms)
  âœ— GET /api/merchant/analytics/sales/trends - Sales trends (42ms)
  âœ— GET /api/merchant/analytics/sales/by-time - Sales by time (42ms)
  âœ— GET /api/merchant/analytics/sales/by-day - Sales by day (45ms)
  âœ— GET /api/merchant/analytics/products/top-selling - Top selling products (45ms)
  âœ— GET /api/merchant/analytics/categories/performance - Category performance (44ms)
  âœ— GET /api/merchant/analytics/customers/insights - Customer insights (42ms)
  âœ— GET /api/merchant/analytics/inventory/status - Inventory status (42ms)
  âœ— GET /api/merchant/analytics/payments/breakdown - Payment breakdown (45ms)
  âœ— GET /api/merchant/analytics/forecast/sales - Sales forecast (54ms)
  âœ— GET /api/merchant/analytics/trends/seasonal - Seasonal trends (52ms)
  âœ“ GET /api/merchant/analytics/cache/stats - Cache statistics (41ms)
  âœ— GET /api/merchant/analytics/export - Export analytics (31ms)

ğŸ“¦ Testing Audit Log Endpoints (17 endpoints)...
  âœ“ GET /api/merchant/audit/logs - List audit logs (68ms)
  âœ— GET /api/merchant/audit/stats - Get audit statistics (46ms)
  âœ— GET /api/merchant/audit/search - Search audit logs (24ms)
  âœ— GET /api/merchant/audit/timeline - Get timeline (45ms)
  âœ— GET /api/merchant/audit/timeline/today - Get today's timeline (48ms)
  âœ— GET /api/merchant/audit/timeline/recent - Get recent timeline (44ms)
  âœ“ GET /api/merchant/audit/timeline/summary - Get timeline summary (45ms)
  âœ— GET /api/merchant/audit/timeline/critical - Get critical events (44ms)
  âœ“ GET /api/merchant/audit/timeline/heatmap - Get activity heatmap (46ms)
  âœ— GET /api/merchant/audit/retention/stats - Retention statistics (44ms)
  âœ— GET /api/merchant/audit/retention/compliance - Compliance status (64ms)
  âœ“ GET /api/merchant/audit/export - Export audit logs (47ms)

ğŸ“¦ Testing Upload Endpoints (6 endpoints)...
  â„¹ Note: Upload endpoints require multipart/form-data and actual file uploads
  â„¹ Skipping upload tests in this automated suite
  â—‹ POST /api/merchant/uploads/product-image
  â—‹ POST /api/merchant/uploads/product-images
  â—‹ POST /api/merchant/uploads/store-logo
  â—‹ POST /api/merchant/uploads/store-banner
  â—‹ POST /api/merchant/uploads/video
  â—‹ DELETE /api/merchant/uploads/:publicId

ğŸ“¦ Testing Cleanup...
  âœ“ Logged out successfully

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     TEST EXECUTION SUMMARY                        
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Total Tests:     76
Passed:          19 (25.00%)
Failed:          46 (60.53%)
Skipped:         11
Duration:        4.17s
Avg Response:    45ms

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ FAILED TESTS:

  âœ— Authentication - POST /api/merchant/auth/reset-password - Reset password (invalid token)
    POST /api/merchant/auth/reset-password
    Expected: 400, Got: 404

  âœ— Authentication - POST /api/merchant/auth/verify-email - Verify email (invalid token)
    POST /api/merchant/auth/verify-email
    Expected: 400, Got: 404

  âœ— Authentication - POST /api/merchant/auth/logout - Logout merchant
    POST /api/merchant/auth/logout
    Expected: 200, Got: 500

  âœ— Dashboard - GET /api/merchant/dashboard/activity - Get recent activity
    GET /api/merchant/dashboard/activity
    Expected: 200, Got: 200

  âœ— Dashboard - GET /api/merchant/dashboard/top-products - Get top selling products
    GET /api/merchant/dashboard/top-products
    Expected: 200, Got: 200

  âœ— Dashboard - GET /api/merchant/dashboard/sales-data - Get sales chart data
    GET /api/merchant/dashboard/sales-data
    Expected: 200, Got: 200

  âœ— Dashboard - GET /api/merchant/dashboard/low-stock - Get low stock alerts
    GET /api/merchant/dashboard/low-stock
    Expected: 200, Got: 200

  âœ— Onboarding - GET /api/merchant/onboarding/status - Get onboarding status
    GET /api/merchant/onboarding/status
    Expected: 200, Got: 200

  âœ— Onboarding - POST /api/merchant/onboarding/step/1 - Save step 1 data
    POST /api/merchant/onboarding/step/1
    Expected: 200, Got: 400

  âœ— Onboarding - POST /api/merchant/onboarding/step/2 - Save step 2 data
    POST /api/merchant/onboarding/step/2
    Expected: 200, Got: 400

  âœ— Onboarding - POST /api/merchant/onboarding/step/5 - Save step 5 data
    POST /api/merchant/onboarding/step/5
    Expected: 200, Got: 400

  âœ— Onboarding - POST /api/merchant/onboarding/submit - Submit for approval
    POST /api/merchant/onboarding/submit
    Expected: 200, Got: 500

  âœ— Team - GET /api/merchant/team - List team members
    GET /api/merchant/team
    Expected: 200, Got: 200

  âœ— Team - POST /api/merchant/team/invite - Invite team member
    POST /api/merchant/team/invite
    Expected: 201, Got: 201

  âœ— Products - POST /api/merchant/products - Create product
    POST /api/merchant/products
    Expected: 201, Got: 400

  âœ— Orders - GET /api/merchant/orders - List orders
    GET /api/merchant/orders
    Expected: 200, Got: 401

  âœ— Orders - GET /api/merchant/orders/analytics - Get order analytics
    GET /api/merchant/orders/analytics
    Expected: 200, Got: 401

  âœ— Cashback - GET /api/merchant/cashback - List cashback requests
    GET /api/merchant/cashback
    Expected: 200, Got: 401

  âœ— Cashback - GET /api/merchant/cashback/stats - Get cashback statistics
    GET /api/merchant/cashback/stats
    Expected: 200, Got: 401

  âœ— Cashback - GET /api/merchant/cashback/pending-count - Get pending count
    GET /api/merchant/cashback/pending-count
    Expected: 200, Got: 401

  âœ— Cashback - GET /api/merchant/cashback/export - Export cashback data
    GET /api/merchant/cashback/export
    Expected: 200, Got: 401

  âœ— Notifications - GET /api/merchant/notifications - List notifications
    GET /api/merchant/notifications
    Expected: 200, Got: 401

  âœ— Notifications - GET /api/merchant/notifications/unread-count - Get unread count
    GET /api/merchant/notifications/unread-count
    Expected: 200, Got: 401

  âœ— Notifications - GET /api/merchant/notifications/stats - Get notification stats
    GET /api/merchant/notifications/stats
    Expected: 200, Got: 401

  âœ— Notifications - POST /api/merchant/notifications/mark-all-read - Mark all as read
    POST /api/merchant/notifications/mark-all-read
    Expected: 200, Got: 500

  âœ— Notifications - DELETE /api/merchant/notifications/clear-all - Clear all notifications
    DELETE /api/merchant/notifications/clear-all
    Expected: 200, Got: 500

  âœ— Analytics - GET /api/merchant/analytics/sales/overview - Sales overview
    GET /api/merchant/analytics/sales/overview
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/sales/trends - Sales trends
    GET /api/merchant/analytics/sales/trends
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/sales/by-time - Sales by time
    GET /api/merchant/analytics/sales/by-time
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/sales/by-day - Sales by day
    GET /api/merchant/analytics/sales/by-day
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/products/top-selling - Top selling products
    GET /api/merchant/analytics/products/top-selling
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/categories/performance - Category performance
    GET /api/merchant/analytics/categories/performance
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/customers/insights - Customer insights
    GET /api/merchant/analytics/customers/insights
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/inventory/status - Inventory status
    GET /api/merchant/analytics/inventory/status
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/payments/breakdown - Payment breakdown
    GET /api/merchant/analytics/payments/breakdown
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/forecast/sales - Sales forecast
    GET /api/merchant/analytics/forecast/sales
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/trends/seasonal - Seasonal trends
    GET /api/merchant/analytics/trends/seasonal
    Expected: 200, Got: 404

  âœ— Analytics - GET /api/merchant/analytics/export - Export analytics
    GET /api/merchant/analytics/export
    Expected: 200, Got: 404

  âœ— Audit - GET /api/merchant/audit/stats - Get audit statistics
    GET /api/merchant/audit/stats
    Expected: 200, Got: 200

  âœ— Audit - GET /api/merchant/audit/search - Search audit logs
    GET /api/merchant/audit/search
    Expected: 200, Got: 400

  âœ— Audit - GET /api/merchant/audit/timeline - Get timeline
    GET /api/merchant/audit/timeline
    Expected: 200, Got: 200

  âœ— Audit - GET /api/merchant/audit/timeline/today - Get today's timeline
    GET /api/merchant/audit/timeline/today
    Expected: 200, Got: 200

  âœ— Audit - GET /api/merchant/audit/timeline/recent - Get recent timeline
    GET /api/merchant/audit/timeline/recent
    Expected: 200, Got: 200

  âœ— Audit - GET /api/merchant/audit/timeline/critical - Get critical events
    GET /api/merchant/audit/timeline/critical
    Expected: 200, Got: 200

  âœ— Audit - GET /api/merchant/audit/retention/stats - Retention statistics
    GET /api/merchant/audit/retention/stats
    Expected: 200, Got: 200

  âœ— Audit - GET /api/merchant/audit/retention/compliance - Compliance status
    GET /api/merchant/audit/retention/compliance
    Expected: 200, Got: 200

  âœ“ Test results saved to: ./tests/e2e/results/test-results.json
